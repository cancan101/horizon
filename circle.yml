## Customize the test machine
machine:

  timezone:
    America/Los_Angeles # Set the timezone

  # Version of ruby to use
  node:
    version:
      4.2.2

  post:
    - ./test/serve.js:
      background: true


## Customize dependencies
dependencies:
  # Cache directories for speed
  cache_directories:
    - client/node_modules
    - server/node_modules
  pre:
    # Stop default services
    - sudo service redis-server stop
    - sudo service postgresql stop
    - sudo service mysql stop

    # Prepare for client tests
    - npm prune && npm install:
        pwd: client
    - ./node_modules/gulp-cli/bin/gulp.js compile-tests:
        pwd: client

    # Prepare for server tests
    - npm prune && npm install:
        pwd: server

## Customize test commands
test:
  post:
    # Run client tests
    - mocha-phantomjs test/test-es5.html:
        pwd: client
        parallel: true
    # Run client tests
    - ./node_modules/mocha-phantomjs/bin/mocha-phantomjs test/test-es5.html:
        pwd: client
        parallel: true
    # Run server tests
    - npm test:
        pwd: server
        parallel: true
